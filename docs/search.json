[
  {
    "objectID": "tools/stepsforDate_index_formatting.html",
    "href": "tools/stepsforDate_index_formatting.html",
    "title": "Steps for formatting Date and Creating Index",
    "section": "",
    "text": "Code\n#source(\"common_functions.R\") # should i be using this one?? not a good idea since many of the formulas return different values\n\n# Loading R packages. originally was using common functions but trying not to use\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(tidyverse,\n               tsibble, fable,\n               feasts, tsibbledata,\n               fable.prophet,\n               patchwork,\n               lubridate,\n               rio,\n               ggplot2,\n               kableExtra, tidyquant\n               )\n\n\nThe following is steps to check in what format the date column is in in a new dataset. Then to convert to DATE format to do time series research\n\nImport Data:\nCheck date Column Type:\nConvert date to Date Format:\n\n\n\nCode\n# the rename is for a different df\n\n# Step 1: Import your data\ndf &lt;- read.csv(\"https://byuistats.github.io/timeseries/data/Vessels_Trade_US.csv\") \n# We'll assume the data has a column called 'date' (replace with the actual column name) and a 'value' column\n\n\n# Step 2: Check the structure of the 'date' column to verify its type\nstr(df$date)  # This will show you if the date column is a character, Date, or something else\n\n\n# Convert 'date' column to Date type if it's in character format \n# 2.1 reomve unwanted columns or\ndf1 &lt;- df |&gt;\n  mutate(date = lubridate::mdy(date) # date is date columm name\n         # mdy(date) mdy is current order of date, lubridate will format to ymd. \n       #dplyr::select(-comments) # remove unwanted columns\n         ) |&gt;\n  rename(x = constructionequip_ord, y = constructionequip_ship) # rename columns\n\n# 2.1 Convert 'Date' column to yearquarter format\ndf$Date &lt;- lubridate::ymd(df$Date) # df2\n\n\n\n# Verify the 'date' column is now in the correct format (should be Date type)\nstr(df$date)  # Should now return 'date'\n\n\nDoing mutate by getting weekly average\n\n\nCode\n# Set symbol and date range for Apple\nsymbol &lt;- \"AAPL\"\ndate_start &lt;- \"2022-01-01\"\ndate_end &lt;- \"2024-01-01\"\n\n# Download the stock data\nstock_df &lt;- tq_get(symbol, from = date_start, to = date_end, get = \"stock.prices\")\n\n# Convert to a tsibble\nstock_ts &lt;- stock_df %&gt;%\n  mutate(dates = lubridate::ymd(date), value = adjusted) %&gt;%\n  mutate(year_week = yearweek(dates)) |&gt;\n  group_by(year_week) |&gt;\n  summarise(value = mean(value)) |&gt;\n  ungroup() |&gt;\n  as_tsibble(index = year_week)\n\n# Time plot of the daily closing prices\nautoplot(stock_ts, value) +\n  labs(title = \"Time Plot of Apple (AAPL) Daily Closing Prices\",\n       x = \"Date\", y = \"Closing Price (USD)\")\n\n\n\n\n\n\n\n\n\nthe code below was taken from project one, made to plot the time series without doing the monthly mean. The first two lines of code are missing\ndata is for daily data.\n\n\nCode\n# this code is also not complete\n\n\n# the first 2 ts can almost be taken from the previous code.\n# this code was first use but replace by the above code\n\n  dplyr::select(dates, year, months, value)  |&gt; # ts3\n  arrange(dates) |&gt; # ts4\n  mutate(index = tsibble::yearmonth(dates)) |&gt; # ts5\n  as_tsibble(index = index) |&gt; # ts6\n  dplyr::select(index, dates, year, months, value) |&gt; # ts7\n  rename(Vessels = value) # rename value to emphasize data context\nvessels_ts |&gt; #ts8\n  autoplot(.vars = Vessels) +\n  labs(\n    x = \"Month\",\n    y = \"Vessels Cleared Monthly\",\n    title = \"Vessels Cleared Monthly in Foreing Trade for United Sates\"\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nworking with two variables and period column\n\n\nCode\n# I think this file is all for samples, and I edit them so now the code is all mix up hence all the eval=false! sucks \n\ndf &lt;- rio::import(\"https://byuistats.github.io/timeseries/data/constructionequip_manu_orders_shipments.csv\")\n\n# str(df$date)\n\n\ndf1 &lt;- df |&gt;\n  mutate(date = lubridate::mdy(date),\n         constructionequip_ord = as.numeric(constructionequip_ord), # make sure numeric for x variables\n         constructionequip_ship = as.numeric(constructionequip_ship)\n         ) |&gt;\n  rename(x = constructionequip_ord, y = constructionequip_ship) |&gt; # renames columns and converts to numeric\n  select(date, x, y) # re orders and or removes not selected columns\n  \ndf2 &lt;- df1 |&gt; # this makes a new df so either df before or this one is use. \n  mutate(obs = row_number()) |&gt; # makes new column with periods\n  select(obs, x, y)\n\n# can the obs code to make multiple df with different columns. \n\n\n\n\ndata has gaps\nTyson notes\n\nfilling with previous variable\n\nThen there is 100% correlation with the previous variable\n\nFilling with average\n\nsome dataâ€™s average, like weather can vary so it can trow off random,\nusing the same variable as last year is an option, it will just mess with the seasonality\n\ntaking the sum of the lag and lead periods, and divide by two to replace missing\n\nits a good one\n\n\n\n\nCode\ndf0 &lt;- rio::import(\"https://byuistats.github.io/timeseries/data/UNRATENSA.csv\") |&gt;\n    mutate(YM = yearmonth(lubridate::mdy(date)))\ndf &lt;- as_tsibble(df0, index = YM) |&gt;\n  select(ym, cdebt)\ninterval(df) # gives interval: M, D ot Y etc\nhas_gaps(df) # false if none and vice versa True\n\n\n\n\nReading different file formats\n\n\nCode\n# wine_dat &lt;- read_table(\"data/wine.dat\") # resource 3.4.2\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "Date & Index formatting",
      "Steps for formatting Date and Creating Index"
    ]
  }
]